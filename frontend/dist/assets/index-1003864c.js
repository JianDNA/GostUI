import{G as e,H as t,ag as a,y as r,J as s,aw as o,ax as n,ay as l,c as i,z as u,A as d,P as c,L as m,M as h,u as p,K as f,T as g,az as _,aA as v,at as E}from"./vue-9e38bd25.js";import{v as y}from"./utils-c29d00eb.js";import{E as S,a as w,m as T,u as A,l as I,b as R,c as b,s as L,t as U,i as O}from"./element-plus-a98c71bf.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const k=(e,t)=>{const a=e.__vccOpts||e;for(const[r,s]of t)a[r]=s;return a};const D=k({name:"App",async created(){if(this.$store.getters["user/token"])try{await this.$store.dispatch("user/initializeAuth")}catch(e){}}},[["render",function(o,n,l,i,u,d){const c=a("router-view");return r(),e(c,null,{default:t((({Component:t})=>[(r(),e(s(t)))])),_:1})}]]),P={},N=function(e,t,a){if(!t||0===t.length)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e=function(e){return"/"+e}(e))in P)return;P[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(!!a)for(let a=r.length-1;a>=0;a--){const s=r[a];if(s.href===e&&(!t||"stylesheet"===s.rel))return}else if(document.querySelector(`link[href="${e}"]${s}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((t,a)=>{o.addEventListener("load",t),o.addEventListener("error",(()=>a(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e())).catch((e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}))},G=async()=>{const{API_BASE_URL:e,API_CONFIG:t,API_CONFIGS:a}=await N((()=>import("./api-54abda4b.js")),[]);return{API_BASE_URL:e,API_CONFIG:t,API_CONFIGS:a}};let x="http://localhost:3000/api";G().then((({API_BASE_URL:e,API_CONFIG:t})=>{x=e,C.defaults.baseURL=e,C.defaults.timeout=t.timeout||15e3})).catch(console.error);const C=y.create({baseURL:x,timeout:15e3});C.interceptors.request.use((e=>{const t=q.getters["user/token"];return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e)));let M=!1,F=!1;C.interceptors.response.use((e=>e),(async e=>{var t,a;const{response:r,config:s}=e;if(r)switch(r.status){case 401:if(M||(null==(t=s.url)?void 0:t.includes("/auth/logout")))break;M=!0,q.commit("user/CLEAR_USER_STATE"),"Login"!==J.currentRoute.value.name&&(J.push("/login"),S.error("ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•")),setTimeout((()=>{M=!1}),1e3);break;case 403:S.error("æ²¡æœ‰æƒé™è®¿é—®è¯¥èµ„æº");break;case 404:await async function(e){if("gost"!==localStorage.getItem("api_mode")||F)S.error("è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨");else{F=!0;try{localStorage.setItem("api_mode","direct");const{API_CONFIGS:t}=await G();C.defaults.baseURL=t.direct.baseURL,S.warning({message:"æ£€æµ‹åˆ°GOSTä»£ç†ä¸å¯ç”¨ï¼Œå·²è‡ªåŠ¨åˆ‡æ¢åˆ°ç›´è¿æ¨¡å¼",duration:5e3,showClose:!0}),setTimeout((async()=>{try{return await C(e)}catch(t){}finally{F=!1}}),1e3)}catch(t){S.error("GOSTä»£ç†ä¸å¯ç”¨ï¼Œè¯·æ‰‹åŠ¨åˆ‡æ¢åˆ°ç›´è¿æ¨¡å¼"),F=!1}}}(s);break;case 500:S.error("æœåŠ¡å™¨å†…éƒ¨é”™è¯¯");break;default:S.error((null==(a=r.data)?void 0:a.message)||"è¯·æ±‚å¤±è´¥")}else await async function(e,t){if("gost"!==localStorage.getItem("api_mode")||F||"ECONNREFUSED"!==t.code&&!t.message.includes("Network Error"))S.error("ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥");else{F=!0;try{localStorage.setItem("api_mode","direct");const{API_CONFIGS:t}=await G();C.defaults.baseURL=t.direct.baseURL,S.warning({message:"GOSTä»£ç†è¿æ¥å¤±è´¥ï¼Œå·²è‡ªåŠ¨åˆ‡æ¢åˆ°ç›´è¿æ¨¡å¼",duration:5e3,showClose:!0}),setTimeout((async()=>{try{return await C(e)}catch(t){}finally{F=!1}}),1e3)}catch(a){S.error("ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥GOSTæœåŠ¡çŠ¶æ€"),F=!1}}}(s,e);return Promise.reject(e)}));const q=o({modules:{user:{namespaced:!0,state:{currentUser:JSON.parse(localStorage.getItem("user"))||null,token:localStorage.getItem("token")||null,users:[],loading:!1,error:null},getters:{currentUser:e=>e.currentUser,allUsers:e=>e.users,isAdmin:e=>{var t;return"admin"===(null==(t=e.currentUser)?void 0:t.role)},isLoading:e=>e.loading,error:e=>e.error,isAuthenticated:e=>!!e.token,token:e=>e.token},actions:{async initializeAuth({dispatch:e,state:t}){if(t.token)try{await e("getCurrentUser")}catch(a){e("logout")}},async login({commit:e,dispatch:t},a){var r,s;try{const{data:t}=await C.post("/auth/login",a);return e("SET_TOKEN",t.token),e("SET_CURRENT_USER",t.user),t.user}catch(o){throw(null==(s=null==(r=o.response)?void 0:r.data)?void 0:s.message)||"ç™»å½•å¤±è´¥"}},async logout({commit:e},t=!1){var a;try{!t&&(null==(a=e.state)?void 0:a.token)&&await C.post("/auth/logout")}catch(r){}finally{e("CLEAR_USER_STATE")}},async getCurrentUser({commit:e}){try{const t=await C.get("/users/me"),a=t.data.success?t.data.data:t.data;return e("SET_CURRENT_USER",a),a}catch(t){throw t}},async fetchUsers({commit:e}){var t,a;try{e("setLoading",!0);const{data:t}=await C.get("/users");return e("setUsers",t),t}catch(r){throw e("setError",(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥"),r}finally{e("setLoading",!1)}},async createUser({commit:e,dispatch:t},a){var r,s;try{const{data:t}=await C.post("/users",a);return e("addUser",t),t}catch(o){throw(null==(s=null==(r=o.response)?void 0:r.data)?void 0:s.message)||"åˆ›å»ºç”¨æˆ·å¤±è´¥"}},async updateUser({commit:e},{id:t,data:a}){var r,s;try{const r=await C.put(`/users/${t}`,a);return e("updateUserInList",r.data),r.data}catch(o){throw(null==(s=null==(r=o.response)?void 0:r.data)?void 0:s.message)||"æ›´æ–°ç”¨æˆ·å¤±è´¥"}},async deleteUser({commit:e},t){var a,r;try{await C.delete(`/users/${t}`),e("removeUser",t)}catch(s){throw(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"åˆ é™¤ç”¨æˆ·å¤±è´¥"}}},mutations:{SET_CURRENT_USER(e,t){e.currentUser=t,t?localStorage.setItem("user",JSON.stringify(t)):localStorage.removeItem("user"),e.error=null},SET_TOKEN(e,t){e.token=t,t?localStorage.setItem("token",t):localStorage.removeItem("token")},CLEAR_USER_STATE(e){e.currentUser=null,e.token=null,localStorage.removeItem("token"),localStorage.removeItem("user")},setUsers(e,t){e.users=t,e.error=null},addUser(e,t){e.users.push(t),e.error=null},updateUserInList(e,t){var a;const r=e.users.findIndex((e=>e.id===t.id));-1!==r&&e.users.splice(r,1,t),(null==(a=e.currentUser)?void 0:a.id)===t.id&&(e.currentUser=t,localStorage.setItem("user",JSON.stringify(t))),e.error=null},removeUser(e,t){e.users=e.users.filter((e=>e.id!==t)),e.error=null},setLoading(e,t){e.loading=t},setError(e,t){e.error=t}}},rules:{namespaced:!0,state:{rules:[],loading:!1,error:null},getters:{allRules:e=>e.rules,isLoading:e=>e.loading,error:e=>e.error},actions:{async fetchRules({commit:e}){var t,a;try{e("setLoading",!0);const{data:t}=await C.get("/rules");return e("setRules",t),t}catch(r){throw e("setError",(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"è·å–è§„åˆ™åˆ—è¡¨å¤±è´¥"),r}finally{e("setLoading",!1)}},async createRule({commit:e},t){var a,r;try{const{data:a}=await C.post("/rules",{data:t});return e("addRule",a),a}catch(s){throw(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"åˆ›å»ºè§„åˆ™å¤±è´¥"}},async updateRule({commit:e},{id:t,data:a}){var r,s;try{const r=await C.put(`/rules/${t}`,{data:a});return e("updateRuleInList",r.data),r.data}catch(o){throw(null==(s=null==(r=o.response)?void 0:r.data)?void 0:s.message)||"æ›´æ–°è§„åˆ™å¤±è´¥"}},async deleteRule({commit:e},t){var a,r;try{await C.delete(`/rules/${t}`),e("removeRule",t)}catch(s){throw(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"åˆ é™¤è§„åˆ™å¤±è´¥"}}},mutations:{setRules(e,t){e.rules=t,e.error=null},addRule(e,t){e.rules.push(t),e.error=null},updateRuleInList(e,t){const a=e.rules.findIndex((e=>e.id===t.id));-1!==a&&e.rules.splice(a,1,t),e.error=null},removeRule(e,t){e.rules=e.rules.filter((e=>e.id!==t)),e.error=null},setLoading(e,t){e.loading=t},setError(e,t){e.error=t}}},traffic:{namespaced:!0,state:{stats:null,topUsers:[],loading:!1,error:null},mutations:{SET_STATS(e,t){e.stats=t,e.error=null},SET_TOP_USERS(e,t){e.topUsers=t},SET_LOADING(e,t){e.loading=t},SET_ERROR(e,t){e.error=t}},actions:{async fetchStats({commit:e}){var t,a;try{e("SET_LOADING",!0);const t=(await C.get("/dashboard/overview")).data.data,a={activeUsers:t.users.active,totalUsers:t.users.total,activeRules:t.rules.total,totalTraffic:t.traffic.totalUsed,totalBytesIn:Math.floor(.4*t.traffic.totalUsed),totalBytesOut:Math.floor(.6*t.traffic.totalUsed),traffic24h:t.traffic.total24h,activeUsers24h:t.traffic.activeUsers24h};return e("SET_STATS",a),a}catch(r){throw e("SET_ERROR",(null==(a=null==(t=r.response)?void 0:t.data)?void 0:a.message)||"è·å–æµé‡ç»Ÿè®¡å¤±è´¥"),r}finally{e("SET_LOADING",!1)}},async fetchTopUsers({commit:e},{period:t=7,limit:a=10}){try{e("SET_LOADING",!0);const r=(await C.get("/dashboard/traffic-ranking",{params:{days:t,limit:a}})).data.data;return e("SET_TOP_USERS",r),r}catch(r){throw e("SET_ERROR",r.message),r}finally{e("SET_LOADING",!1)}},async fetchTrafficLogs({commit:e},t={}){var a,r,s,o,n,l,i,u;try{e("SET_LOADING",!0);const i=(await C.get("/traffic/logs",{params:t})).data.data;return{data:{logs:i.logs||[],total:i.total||0,stats:{total:(null==(a=i.stats)?void 0:a.total)||0,upload:(null==(r=i.stats)?void 0:r.upload)||0,download:(null==(s=i.stats)?void 0:s.download)||0},chartData:{timestamps:(null==(o=i.chartData)?void 0:o.timestamps)||[],upload:(null==(n=i.chartData)?void 0:n.upload)||[],download:(null==(l=i.chartData)?void 0:l.download)||[]}}}}catch(d){throw e("SET_ERROR",(null==(u=null==(i=d.response)?void 0:i.data)?void 0:u.message)||d.message),d}finally{e("SET_LOADING",!1)}}},getters:{trafficStats:e=>e.stats,topUsers:e=>e.topUsers,isLoading:e=>e.loading,hasError:e=>!!e.error,errorMessage:e=>e.error,totalTraffic:e=>e.stats?e.stats.totalBytesIn+e.stats.totalBytesOut:0,formattedTraffic:(e,t)=>{const a=t.totalTraffic;if(0===a)return"0 B";const r=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,r),2)+" "+["B","KB","MB","GB","TB"][r]}}},gost:{namespaced:!0,state:{status:null,loading:!1,error:null,portForwards:[],systemInfo:null},mutations:{SET_STATUS(e,t){e.status=t,e.error=null,t&&t.portForwards?e.portForwards=t.portForwards:e.portForwards=[],t&&t.systemInfo?e.systemInfo=t.systemInfo:e.systemInfo=null},SET_LOADING(e,t){e.loading=t},SET_ERROR(e,t){e.error=t}},actions:{async fetchStatus({commit:e,rootGetters:t}){var a,r;try{e("SET_LOADING",!0);const a=t["user/isAdmin"]?"/gost/status":"/gost/status/basic",r=await C.get(a);return e("SET_STATUS",r.data.data),r.data.data}catch(s){throw e("SET_ERROR",(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"è·å–GostæœåŠ¡çŠ¶æ€å¤±è´¥"),s}finally{e("SET_LOADING",!1)}},async startService({commit:e,dispatch:t}){var a,r;try{return e("SET_LOADING",!0),await C.post("/gost/start"),t("fetchStatus")}catch(s){throw e("SET_ERROR",(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"å¯åŠ¨GostæœåŠ¡å¤±è´¥"),s}finally{e("SET_LOADING",!1)}},async stopService({commit:e,dispatch:t}){var a,r;try{return e("SET_LOADING",!0),await C.post("/gost/stop"),t("fetchStatus")}catch(s){throw e("SET_ERROR",(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"åœæ­¢GostæœåŠ¡å¤±è´¥"),s}finally{e("SET_LOADING",!1)}},async restartService({commit:e,dispatch:t}){var a,r;try{return e("SET_LOADING",!0),await C.post("/gost/restart"),t("fetchStatus")}catch(s){throw e("SET_ERROR",(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||"é‡å¯GostæœåŠ¡å¤±è´¥"),s}finally{e("SET_LOADING",!1)}}},getters:{isRunning:e=>{var t;return(null==(t=e.status)?void 0:t.isRunning)||!1},pid:e=>{var t;return null==(t=e.status)?void 0:t.pid},portForwards:e=>e.portForwards||[],systemInfo:e=>e.systemInfo,isLoading:e=>e.loading,hasError:e=>!!e.error,errorMessage:e=>e.error}}}}),B={class:"navbar"},j={class:"right"},$={class:"el-dropdown-link"},z=k({__name:"Navbar",setup(e){const s=n(),o=l(),f=i((()=>s.getters["user/currentUser"])),g=async e=>{if("logout"===e)try{await s.dispatch("user/logout"),o.push("/login")}catch(t){S.error("é€€å‡ºç™»å½•å¤±è´¥")}};return(e,s)=>{const o=a("el-icon"),n=a("el-dropdown-item"),l=a("el-dropdown-menu"),i=a("el-dropdown");return r(),u("div",B,[s[1]||(s[1]=d("div",{class:"left"},[d("h2",null,"GOST ç®¡ç†ç³»ç»Ÿ")],-1)),d("div",j,[c(i,{onCommand:g},{dropdown:t((()=>[c(l,null,{default:t((()=>[c(n,{command:"logout"},{default:t((()=>s[0]||(s[0]=[m("é€€å‡ºç™»å½•")]))),_:1,__:[0]})])),_:1})])),default:t((()=>{var e;return[d("span",$,[m(h(null==(e=f.value)?void 0:e.username)+" ",1),c(o,{class:"el-icon--right"},{default:t((()=>[c(p(w))])),_:1})])]})),_:1})])])}}},[["__scopeId","data-v-d01f51a7"]]),V=()=>N((()=>import("./UserForwardRules-73491e88.js")),["assets/UserForwardRules-73491e88.js","assets/vue-9e38bd25.js","assets/element-plus-a98c71bf.js","assets/utils-c29d00eb.js","assets/api-c059019c.js","assets/UserForwardRules-f0f41cce.css"]),W=[{path:"/login",name:"Login",component:()=>N((()=>import("./Login-15a830f5.js")),["assets/Login-15a830f5.js","assets/vue-9e38bd25.js","assets/element-plus-a98c71bf.js","assets/utils-c29d00eb.js","assets/Login-dd057d76.css"]),meta:{requiresAuth:!1}},{path:"/",component:k({__name:"Layout",setup(o){const l=n(),u=i((()=>l.getters["user/isAdmin"])),m=i((()=>l.getters["user/currentUser"])),h=i((()=>{var e;const t=null==(e=m.value)?void 0:e.username;return"admin"===t||"test"===t}));return(o,n)=>{const l=a("el-icon"),i=a("el-menu-item"),m=a("el-menu"),_=a("el-aside"),v=a("el-header"),E=a("router-view"),y=a("el-main"),S=a("el-container");return r(),e(S,{class:"app-wrapper"},{default:t((()=>[c(_,{width:"200px",class:"sidebar-container"},{default:t((()=>[c(m,{router:!0,"default-active":o.$route.path,class:"el-menu-vertical","background-color":"#304156","text-color":"#bfcbd9","active-text-color":"#409EFF"},{default:t((()=>[c(i,{index:"/dashboard"},{default:t((()=>[c(l,null,{default:t((()=>[c(p(T))])),_:1}),n[0]||(n[0]=d("span",null,"ä»ªè¡¨ç›˜",-1))])),_:1,__:[0]}),u.value?(r(),e(i,{key:0,index:"/admin"},{default:t((()=>[c(l,null,{default:t((()=>[c(p(A))])),_:1}),n[1]||(n[1]=d("span",null,"ç”¨æˆ·ç®¡ç†",-1))])),_:1,__:[1]})):f("",!0),c(i,{index:"/rules"},{default:t((()=>[c(l,null,{default:t((()=>[c(p(I))])),_:1}),n[2]||(n[2]=d("span",null,"è§„åˆ™ç®¡ç†",-1))])),_:1,__:[2]}),c(i,{index:"/profile"},{default:t((()=>[c(l,null,{default:t((()=>[c(p(R))])),_:1}),n[3]||(n[3]=d("span",null,"ä¸ªäººä¿¡æ¯",-1))])),_:1,__:[3]}),h.value?(r(),e(i,{key:1,index:"/traffic-test"},{default:t((()=>[c(l,null,{default:t((()=>[c(p(b))])),_:1}),n[4]||(n[4]=d("span",null,"ğŸ§ª APIæµ‹è¯•",-1))])),_:1,__:[4]})):f("",!0),u.value?(r(),e(i,{key:2,index:"/gost-config"},{default:t((()=>[c(l,null,{default:t((()=>[c(p(L))])),_:1}),n[5]||(n[5]=d("span",null,"Gosté…ç½®",-1))])),_:1,__:[5]})):f("",!0),u.value?(r(),e(i,{key:3,index:"/system-status"},{default:t((()=>[c(l,null,{default:t((()=>[c(p(T))])),_:1}),n[6]||(n[6]=d("span",null,"ç³»ç»ŸçŠ¶æ€",-1))])),_:1,__:[6]})):f("",!0),u.value?(r(),e(i,{key:4,index:"/performance-config"},{default:t((()=>[c(l,null,{default:t((()=>[c(p(U))])),_:1}),n[7]||(n[7]=d("span",null,"æ€§èƒ½é…ç½®",-1))])),_:1,__:[7]})):f("",!0)])),_:1},8,["default-active"])])),_:1}),c(S,null,{default:t((()=>[c(v,{height:"60px",class:"header"},{default:t((()=>[c(z)])),_:1}),c(y,null,{default:t((()=>[c(E,null,{default:t((({Component:a})=>[c(g,{name:"fade",mode:"out-in"},{default:t((()=>[(r(),e(s(a)))])),_:2},1024)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-6a0b027a"]]),redirect:"/dashboard",children:[{path:"/dashboard",name:"Dashboard",component:()=>N((()=>import("./Dashboard-6de06913.js")),["assets/Dashboard-6de06913.js","assets/vue-9e38bd25.js","assets/element-plus-a98c71bf.js","assets/utils-c29d00eb.js","assets/charts-37cc03ee.js","assets/Dashboard-da783d02.css"]),meta:{requiresAuth:!0,title:"ä»ªè¡¨ç›˜"}},{path:"/admin",name:"Admin",component:()=>N((()=>import("./UserManagement-973ec8be.js")),["assets/UserManagement-973ec8be.js","assets/element-plus-a98c71bf.js","assets/vue-9e38bd25.js","assets/utils-c29d00eb.js","assets/api-c059019c.js","assets/UserManagement-f4c22536.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"ç”¨æˆ·ç®¡ç†"}},{path:"/rules",name:"Rules",component:V,meta:{requiresAuth:!0,title:"è§„åˆ™ç®¡ç†"}},{path:"/user-forward-rules",name:"UserForwardRules",component:V,meta:{requiresAuth:!0,title:"è½¬å‘è§„åˆ™"}},{path:"/gost-config",name:"GostConfig",component:()=>N((()=>import("./GostConfig-ae695079.js")),["assets/GostConfig-ae695079.js","assets/vue-9e38bd25.js","assets/element-plus-a98c71bf.js","assets/utils-c29d00eb.js","assets/api-c059019c.js","assets/GostConfig-aab359a1.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"Gost é…ç½®"}},{path:"/traffic-test",name:"AdvancedTrafficTest",component:()=>N((()=>import("./AdvancedTrafficTest-b268bc07.js")),["assets/AdvancedTrafficTest-b268bc07.js","assets/api-c059019c.js","assets/api-54abda4b.js","assets/element-plus-a98c71bf.js","assets/vue-9e38bd25.js","assets/utils-c29d00eb.js","assets/AdvancedTrafficTest-6df03544.css"]),meta:{requiresAuth:!0,title:"API & æµé‡æµ‹è¯•",allowedUsers:["admin","test"]}},{path:"/system-status",name:"SystemStatus",component:()=>N((()=>import("./SystemStatus-42919c4e.js")),["assets/SystemStatus-42919c4e.js","assets/vue-9e38bd25.js","assets/element-plus-a98c71bf.js","assets/utils-c29d00eb.js","assets/api-c059019c.js","assets/SystemStatus-61d45cd7.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"ç³»ç»ŸçŠ¶æ€"}},{path:"/performance-config",name:"PerformanceConfig",component:()=>N((()=>import("./PerformanceConfig-42b85a9c.js")),["assets/PerformanceConfig-42b85a9c.js","assets/vue-9e38bd25.js","assets/api-c059019c.js","assets/element-plus-a98c71bf.js","assets/utils-c29d00eb.js","assets/PerformanceConfig-7e04b715.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"æ€§èƒ½é…ç½®"}},{path:"/profile",name:"Profile",component:()=>N((()=>import("./Profile-40f213f2.js")),["assets/Profile-40f213f2.js","assets/element-plus-a98c71bf.js","assets/vue-9e38bd25.js","assets/utils-c29d00eb.js","assets/Profile-f4024d93.css"]),meta:{requiresAuth:!0,title:"ä¸ªäººä¿¡æ¯"}}]}],K=_({history:v(),routes:W});K.beforeEach((async(e,t,a)=>{q.getters["user/token"]&&!q.getters["user/currentUser"]&&await q.dispatch("user/initializeAuth");const r=q.getters["user/isAuthenticated"],s=q.getters["user/isAdmin"];if(e.matched.some((e=>e.meta.requiresAuth))){if(!r)return void a({name:"Login",query:{redirect:e.fullPath}});if(e.matched.some((e=>e.meta.requiresAdmin))&&!s)return void a({name:"Dashboard"});const t=e.matched.find((e=>e.meta.allowedUsers));if(t){const e=q.getters["user/currentUser"];if(!t.meta.allowedUsers.includes(null==e?void 0:e.username))return void a({name:"Dashboard"})}if("AdminTestPanel"===e.name){if(!(e=>{if(!e||"admin"!==e.role)return!1;{const t=new URLSearchParams(window.location.search).get("api_test"),a=localStorage.getItem("api_test_mode");return("true"===t||"true"===a)&&"admin"===e.role}})(q.getters["user/currentUser"]))return void a({name:"Dashboard"})}}"Login"===e.name&&r?a({name:s?"Admin":"Dashboard"}):a()}));const J=K;const H=new class{constructor(){this.isEnabled=!1,this.checkInterval=null}isAdmin(e){return e&&"admin"===e.role}enable(e,t=null){if(!this.isAdmin(e))return!1;if(t&&!this.validateAuthCode(t))return!1;const a=(e=>!(!e||"admin"!==e.role||(localStorage.setItem("api_test_mode","true"),0)))(e);return a&&(this.isEnabled=!0,this.startMonitoring(),this.showProductionWarning()),a}disable(){localStorage.removeItem("api_test_mode"),this.isEnabled=!1,this.stopMonitoring()}validateAuthCode(e){return["ADMIN_TEST_2024","PROD_DEBUG_MODE","EMERGENCY_ACCESS"].includes(e)}startMonitoring(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=setInterval((()=>{}),3e5)}stopMonitoring(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}showProductionWarning(){this.showWarningBanner()}showWarningBanner(){const e=document.createElement("div");e.id="production-test-warning",e.innerHTML='\n      <div style="\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        background: #ff4757;\n        color: white;\n        padding: 10px;\n        text-align: center;\n        font-weight: bold;\n        z-index: 9999;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n      ">\n        âš ï¸ ç”Ÿäº§ç¯å¢ƒæµ‹è¯•æ¨¡å¼å·²å¯ç”¨ - è¯·è°¨æ…æ“ä½œ\n        <button onclick="window.productionTestEnabler.disable(); this.parentElement.parentElement.remove();" \n                style="margin-left: 20px; padding: 5px 10px; background: white; color: #ff4757; border: none; border-radius: 3px; cursor: pointer;">\n          ç¦ç”¨æµ‹è¯•æ¨¡å¼\n        </button>\n      </div>\n    ',document.body.appendChild(e)}getStatus(){return{isProduction:!0,isEnabled:this.isEnabled,hasMonitoring:!!this.checkInterval,enabledAt:localStorage.getItem("api_test_mode_enabled_at"),enabledBy:localStorage.getItem("api_test_mode_enabled_by")}}quickEnable(e){return!!this.isAdmin(e)&&(localStorage.setItem("api_test_mode_enabled_at",(new Date).toISOString()),localStorage.setItem("api_test_mode_enabled_by",e.username),this.enable(e))}};window.productionTestEnabler=H;const Y=E(D);Y.use(O,{locale:{name:"zh-cn",el:{breadcrumb:{label:"é¢åŒ…å±‘"},colorpicker:{confirm:"ç¡®å®š",clear:"æ¸…ç©º",defaultLabel:"é¢œè‰²é€‰æ‹©å™¨",description:"å½“å‰é¢œè‰² {color}ï¼ŒæŒ‰ Enter é”®é€‰æ‹©æ–°é¢œè‰²",alphaLabel:"é€‰æ‹©é€æ˜åº¦çš„å€¼"},datepicker:{now:"æ­¤åˆ»",today:"ä»Šå¤©",cancel:"å–æ¶ˆ",clear:"æ¸…ç©º",confirm:"ç¡®å®š",dateTablePrompt:"ä½¿ç”¨æ–¹å‘é”®ä¸ Enter é”®å¯é€‰æ‹©æ—¥æœŸ",monthTablePrompt:"ä½¿ç”¨æ–¹å‘é”®ä¸ Enter é”®å¯é€‰æ‹©æœˆä»½",yearTablePrompt:"ä½¿ç”¨æ–¹å‘é”®ä¸ Enter é”®å¯é€‰æ‹©å¹´ä»½",selectedDate:"å·²é€‰æ—¥æœŸ",selectDate:"é€‰æ‹©æ—¥æœŸ",selectTime:"é€‰æ‹©æ—¶é—´",startDate:"å¼€å§‹æ—¥æœŸ",startTime:"å¼€å§‹æ—¶é—´",endDate:"ç»“æŸæ—¥æœŸ",endTime:"ç»“æŸæ—¶é—´",prevYear:"å‰ä¸€å¹´",nextYear:"åä¸€å¹´",prevMonth:"ä¸Šä¸ªæœˆ",nextMonth:"ä¸‹ä¸ªæœˆ",year:"å¹´",month1:"1 æœˆ",month2:"2 æœˆ",month3:"3 æœˆ",month4:"4 æœˆ",month5:"5 æœˆ",month6:"6 æœˆ",month7:"7 æœˆ",month8:"8 æœˆ",month9:"9 æœˆ",month10:"10 æœˆ",month11:"11 æœˆ",month12:"12 æœˆ",weeks:{sun:"æ—¥",mon:"ä¸€",tue:"äºŒ",wed:"ä¸‰",thu:"å››",fri:"äº”",sat:"å…­"},weeksFull:{sun:"æ˜ŸæœŸæ—¥",mon:"æ˜ŸæœŸä¸€",tue:"æ˜ŸæœŸäºŒ",wed:"æ˜ŸæœŸä¸‰",thu:"æ˜ŸæœŸå››",fri:"æ˜ŸæœŸäº”",sat:"æ˜ŸæœŸå…­"},months:{jan:"ä¸€æœˆ",feb:"äºŒæœˆ",mar:"ä¸‰æœˆ",apr:"å››æœˆ",may:"äº”æœˆ",jun:"å…­æœˆ",jul:"ä¸ƒæœˆ",aug:"å…«æœˆ",sep:"ä¹æœˆ",oct:"åæœˆ",nov:"åä¸€æœˆ",dec:"åäºŒæœˆ"}},inputNumber:{decrease:"å‡å°‘æ•°å€¼",increase:"å¢åŠ æ•°å€¼"},select:{loading:"åŠ è½½ä¸­",noMatch:"æ— åŒ¹é…æ•°æ®",noData:"æ— æ•°æ®",placeholder:"è¯·é€‰æ‹©"},dropdown:{toggleDropdown:"åˆ‡æ¢ä¸‹æ‹‰é€‰é¡¹"},mention:{loading:"åŠ è½½ä¸­"},cascader:{noMatch:"æ— åŒ¹é…æ•°æ®",loading:"åŠ è½½ä¸­",placeholder:"è¯·é€‰æ‹©",noData:"æš‚æ— æ•°æ®"},pagination:{goto:"å‰å¾€",pagesize:"æ¡/é¡µ",total:"å…± {total} æ¡",pageClassifier:"é¡µ",page:"é¡µ",prev:"ä¸Šä¸€é¡µ",next:"ä¸‹ä¸€é¡µ",currentPage:"ç¬¬ {pager} é¡µ",prevPages:"å‘å‰ {pager} é¡µ",nextPages:"å‘å {pager} é¡µ",deprecationWarning:"ä½ ä½¿ç”¨äº†ä¸€äº›å·²è¢«åºŸå¼ƒçš„ç”¨æ³•ï¼Œè¯·å‚è€ƒ el-pagination çš„å®˜æ–¹æ–‡æ¡£"},dialog:{close:"å…³é—­æ­¤å¯¹è¯æ¡†"},drawer:{close:"å…³é—­æ­¤å¯¹è¯æ¡†"},messagebox:{title:"æç¤º",confirm:"ç¡®å®š",cancel:"å–æ¶ˆ",error:"è¾“å…¥çš„æ•°æ®ä¸åˆæ³•!",close:"å…³é—­æ­¤å¯¹è¯æ¡†"},upload:{deleteTip:"æŒ‰ Delete é”®å¯åˆ é™¤",delete:"åˆ é™¤",preview:"æŸ¥çœ‹å›¾ç‰‡",continue:"ç»§ç»­ä¸Šä¼ "},slider:{defaultLabel:"æ»‘å—ä»‹äº {min} è‡³ {max}",defaultRangeStartLabel:"é€‰æ‹©èµ·å§‹å€¼",defaultRangeEndLabel:"é€‰æ‹©ç»“æŸå€¼"},table:{emptyText:"æš‚æ— æ•°æ®",confirmFilter:"ç­›é€‰",resetFilter:"é‡ç½®",clearFilter:"å…¨éƒ¨",sumText:"åˆè®¡"},tour:{next:"ä¸‹ä¸€æ­¥",previous:"ä¸Šä¸€æ­¥",finish:"ç»“æŸå¯¼è§ˆ"},tree:{emptyText:"æš‚æ— æ•°æ®"},transfer:{noMatch:"æ— åŒ¹é…æ•°æ®",noData:"æ— æ•°æ®",titles:["åˆ—è¡¨ 1","åˆ—è¡¨ 2"],filterPlaceholder:"è¯·è¾“å…¥æœç´¢å†…å®¹",noCheckedFormat:"å…± {total} é¡¹",hasCheckedFormat:"å·²é€‰ {checked}/{total} é¡¹"},image:{error:"åŠ è½½å¤±è´¥"},pageHeader:{title:"è¿”å›"},popconfirm:{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ"},carousel:{leftArrow:"ä¸Šä¸€å¼ å¹»ç¯ç‰‡",rightArrow:"ä¸‹ä¸€å¼ å¹»ç¯ç‰‡",indicator:"å¹»ç¯ç‰‡åˆ‡æ¢è‡³ç´¢å¼• {index}"}}}}),Y.use(q),Y.use(J),q.dispatch("user/initializeAuth").then((()=>{})).catch((e=>{})),Y.mount("#app");export{k as _,C as r};
